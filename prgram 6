#include <stdio.h>

int main() {
    int n;
    printf("Enter number of processes: ");
    scanf("%d", &n);

    int pid[n], bt[n], at[n], pr[n], rt[n];
    for(int i=0;i<n;i++){
        pid[i] = i+1;
        printf("Enter arrival time for P%d: ", pid[i]);
        scanf("%d", &at[i]);
        printf("Enter burst time for P%d: ", pid[i]);
        scanf("%d", &bt[i]);
        printf("Enter priority (lower number = higher priority) for P%d: ", pid[i]);
        scanf("%d", &pr[i]);
        rt[i] = bt[i];
    }

    int completed = 0, time = 0, shortest, finish;
    float totalWT = 0, totalTAT = 0;
    int minP, flag = 0;

    while (completed != n) {
        minP = 99999;
        for (int i = 0; i < n; i++) {
            if (at[i] <= time && rt[i] > 0 && pr[i] < minP) {
                minP = pr[i];
                shortest = i;
                flag = 1;
            }
        }

        if (flag == 0) { time++; continue; }

        rt[shortest]--;
        if (rt[shortest] == 0) {
            completed++;
            finish = time + 1;
            int wt = finish - at[shortest] - bt[shortest];
            int tat = finish - at[shortest];
            totalWT += wt;
            totalTAT += tat;
            printf("P%d completed at time %d | WT = %d | TAT = %d\n", pid[shortest], finish, wt, tat);
        }
        time++;
        flag = 0;
    }

    printf("\nAvg Waiting Time = %.2f\n", totalWT / n);
    printf("Avg Turnaround Time = %.2f\n", totalTAT / n);
    return 0;
}
